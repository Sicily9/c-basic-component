# proto_identify_rule.conf
# Edit by Leabo 2006-12-23
# HTTP,FTP,POP3,SMTP,TELNET,KAZAA,ED2K,BT,GNUTELLA,MSN,QQ,YMSG,POPO,GTALK,MSRPC

##############################################################################
########################    NO.01 :  HTTP_RULE_SET   #########################
##############################################################################

[HTTP_RULE_01]
rule_shift	= yes
rule_id		= 1
protocol	= HTTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 3
finger_minlen	= 13
finger_match	= [0|0|9]=OPTIONS%20,GET%20,HEAD%20,POST%20,PUT%20,DELETE%20,TRACE%20,CONNECT%20,MKCOL%20,PROPFIND%20,PROPATCH%20,COPY%20,MOVE%20,LOCK%20,UNLOCK%20&&[0|0|10]!GET%20/.hash&&[0|0|24]!GET%20/announce?info_hash%3d&&[0|10|0]~X-Gnutella-Content-URN:&&[0|0|14]!GET%20/popo2004/
finger_plugin	= http_tcp_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 3
verify_minlen	= 9
verify_match	= [0|0|9]=HTTP/1.1%20,HTTP/1.0%20
verify_plugin	=
verify_bpf_vm	= 
store_shift	= yes

##############################################################################
########################    NO.02 :  FTP_RULE_SET   ##########################
##############################################################################

[FTP_RULE_01]
rule_shift	= yes
rule_id		= 3
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 60
finger_minlen	= 6
finger_match	= [0|0|4]=ABOR
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 60
verify_minlen	= 4
verify_match	= [0|0|4]=225%20,226%20,500%20,501%20,503%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_02]
rule_shift	= yes
rule_id		= 4
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 60
finger_minlen	= 6
finger_match	= [0|0|4]=ACCT
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 60
verify_minlen	= 4
verify_match	= [0|0|4]=230%20,202%20,530%20,500%20,501%20,503%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_03]
rule_shift	= yes
rule_id		= 5
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 60
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=ADAT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 60
verify_minlen	= 4
verify_match	= [0|0|4]=235%20,335%20,503%20,501%20,535%20,500%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_04]
rule_shift	= yes
rule_id		= 6
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 60
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=ALLO
verify_shift	= yes
verify_direc	= respons
verify_depth	= 60
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,202%20,500%20,501%20,504%20,530%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_05]
rule_shift	= yes
rule_id		= 7
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=APPE
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=125%20,425%20,552%20,452%20,502%20,535%20,426%20,532%20,553%20,421%20,226%20,451%20,450%20,500%20,530%20,250%20,551%20,550%20,501%20,534%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_06]
rule_shift	= yes
rule_id		= 8
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 60
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=CCC
verify_shift	= yes
verify_direc	= respons
verify_depth	= 60
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,501%20,503%20,533%20,534%20,535%20,537%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_07]
rule_shift	= yes
rule_id		= 9
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=CDUP
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,500%20,501%20,502%20,421%20,530%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_08]
rule_shift	= yes
rule_id		= 10
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=CONF
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=535%20,533%20,500%20,501%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_09]
rule_shift	= yes
rule_id		= 11
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=CWD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=250%20,500%20,501%20,502%20,421%20,530%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_10]
rule_shift	= yes
rule_id		= 12
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=DELE
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=250%20,450%20,550%20,500520,501%20,502%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_11]
rule_shift	= yes
rule_id		= 13
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=ENC
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=535%20,533%20,500%20,531%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_12]
rule_shift	= yes
rule_id		= 14
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPRT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]=0x35 and ether[1:1]>=0x31 and ether[1:1]<=0x36 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]='5' and tcp_payload[1,1]>='1' and tcp_payload[1,1]<='6' and tcp_payload[2,1]>='0' and tcp_payload[1,1]<='9'

[FTP_RULE_13]
rule_shift	= yes
rule_id		= 15
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPRT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]>=0x31 and ether[0:1]<=0x36 and ether[1:1]=0x32 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]>='1' and tcp_payload[0,1]<='6' and tcp_payload[1,1]='2' and tcp_payload[2,1]>='0' and tcp_payload[1,1]<='9'

[FTP_RULE_14]
rule_shift	= yes
rule_id		= 16
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPRT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]>=0x31 and ether[0:1]<=0x36 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]=0x32
store_shift     = yes
## tcp_payload[0,1]>='1' and tcp_payload[0,1]<='6' and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[1,1]='2'

[FTP_RULE_15]
rule_shift	= yes
rule_id		= 17
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPSV
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]=0x32 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]='2' and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[2,1]>='0' and tcp_payload[2,1]<='9'

[FTP_RULE_16]
rule_shift	= yes
rule_id		= 18
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPSV
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]>=0x31 and ether[0:1]<=0x36 and ether[1:1]=0x32 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]>='1' and tcp_payload[0,1]<='6' and tcp_payload[1,1]='2' and tcp_payload[2,1]>='0' and tcp_payload[2,1]<='9'

[FTP_RULE_17]
rule_shift	= yes
rule_id		= 19
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=EPSV
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]>=0x31 and ether[0:1]<=0x36 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]=0x39
store_shift     = yes
## tcp_payload[0,1]>='1' and tcp_payload[0,1]<='6' and tcp_payload[1,1]>='0' and tcp_payload[2,1]<='9' and tcp_payload[2,1]='9'

[FTP_RULE_18]
rule_shift	= yes
rule_id		= 20
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=FEAT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=211%20,500%20,502%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_19]
rule_shift	= yes
rule_id		= 21
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=LANG
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,500%20,501%20,502%20,504%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_20]
rule_shift	= yes
rule_id		= 22
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=LIST,NLST
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=125%20,425%20,500%20,530%20,150%20,426%20,501%20,534%20,226%20,451%20,502%20,535%20,250%20,450%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_21]
rule_shift	= yes
rule_id		= 23
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=LPRT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]=0x32 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]='2' and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[2,1]>='0' and tcp_payload[2,1]<='9'

[FTP_RULE_22]
rule_shift	= yes
rule_id		= 24
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=LPSV
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=228%20,500%20,501%20,521%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_23]
rule_shift	= yes
rule_id		= 25
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=MIC
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=535%20,533%20,500%20,501%20,521%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_24]
rule_shift	= yes
rule_id		= 26
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=MKD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=257%20,500%20,501%20,502%20,421%20,530%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_25]
rule_shift	= yes
rule_id		= 27
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=MODE
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,500%20,501%20,504%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_26]
rule_shift	= yes
rule_id		= 28
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=OPTS
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,451%20,501%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_27]
rule_shift	= yes
rule_id		= 29
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=PASS
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=230%20,202%20,530%20,500%20,501%20,503%20,421%20,332%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_28]
rule_shift	= yes
rule_id		= 30
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=PASV
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=227%20,500%20,501%20,502%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_29]
rule_shift	= yes
rule_id		= 31
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=PBSZ
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,503%20,500%20,501%20,421%20,530%30
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_30]
rule_shift	= yes
rule_id		= 32
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=PORT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,530%20,534%20,500%20,504%20,431%20,501%20,536%20,421%20,503%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_31]
rule_shift	= yes
rule_id		= 33
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=PWD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=257%20,500%20,501%20,502%20,421%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_32]
rule_shift	= yes
rule_id		= 34
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=QUIT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=221%20,500%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_33]
rule_shift	= yes
rule_id		= 35
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=REIN
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=120%20,220%20,421%20,500%20,502%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_34]
rule_shift	= yes
rule_id		= 36
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=REST
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=500%20,501%20,502%20,530%20,421%20,350%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_35]
rule_shift	= yes
rule_id		= 37
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=RETR
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=125%20,250%20,450%20,421%20,150%20,425%20,550%20,530%20,110%20,426%20,500%20,534%20,226%20,451%20,501%20,535%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_36]
rule_shift	= yes
rule_id		= 38
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 5
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|3]=RMD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=250%20,500%20,501%20,502%20,421%20,530%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_37]
rule_shift	= yes
rule_id		= 39
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=RNFR
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=450%20,550%20,500%20,501%20,502%20,421%20,530%20,350%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_38]
rule_shift	= yes
rule_id		= 40
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=RNTO
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=250%20,532%20,553%20,500%20,501%20,502%20,503%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_39]
rule_shift	= yes
rule_id		= 41
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=SITE
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,202%20,500%20,501%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_40]
rule_shift	= yes
rule_id		= 42
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=SMNT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=202%20,250%20,500%20,501%20,502%20,421%20,530%20,550%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_41]
rule_shift	= yes
rule_id		= 43
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=STAT
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=211%20,212%20,213%20,450%20,500%20,501%20,502%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_42]
rule_shift	= yes
rule_id		= 44
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=STOR,STOU
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=125%20,425%20.552%20,553%20,530%20,150%20,426%20,532%20,500%20,534%20,226%20,451%20,450%20,501%20,535%20,250%20,551%20,452%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_43]
rule_shift	= yes
rule_id		= 45
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=STOR
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=110%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_44]
rule_shift	= yes
rule_id		= 46
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=STRU,TYPE
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,500%20,501%20,504%20,421%20,530%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_45]
rule_shift	= yes
rule_id		= 47
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=SYST
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=215%20,500%20,501%20,502%20,421%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_46]
rule_shift	= yes
rule_id		= 48
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=USER
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=230%20,530%20,500%20,501%20,421%20,331%20,332%20,232%20,336%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_47]
rule_shift	= yes
rule_id		= 49
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XCUP
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20,506%20,502%20,507%20,551%20,521%20,450%20,425%20,451%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_48]
rule_shift	= yes
rule_id		= 50
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XMKD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=257520,251%20,521%20,450%20,506%20,502%20,550%20,501%20,425%20,451%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_49]
rule_shift	= yes
rule_id		= 51
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XPWD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=257%20,251%20,521%20,451%20,506%20,502%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_50]
rule_shift	= yes
rule_id		= 52
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XMKD
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=224%20,250%20,506%20,502%20,521%20,450%20,550%20,501%20,425520,451%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_51]
rule_shift	= yes
rule_id		= 53
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XRCP
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_52]
rule_shift	= yes
rule_id		= 54
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XRCP
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]=0x34 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]='4' and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[2,1]>='0' and tcp_payload[1,1]<='9'

[FTP_RULE_53]
rule_shift	= yes
rule_id		= 55
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XRCP,XRSQ
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]=0x35 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]='5' and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[2,1]>='0' and tcp_payload[1,1]<='9'

[FTP_RULE_54]
rule_shift	= yes
rule_id		= 56
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XRSQ
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 4
verify_match	= [0|0|4]=200520,215%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[FTP_RULE_55]
rule_shift	= yes
rule_id		= 57
protocol	= FTP
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 80
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=XSEM,XSEN,XMAX
verify_shift	= yes
verify_direc	= respons
verify_depth	= 80
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[0:1]>=0x31 and ether[0:1]<=0x36 and ether[1:1]>=0x30 and ether[1:1]<=0x39 and ether[2:1]>=0x30 and ether[2:1]<=0x39
store_shift     = yes
## tcp_payload[0,1]>='1' and tcp_payload[0,1]<='6 'and tcp_payload[1,1]>='0' and tcp_payload[1,1]<='9' and tcp_payload[2,1]>='0' and tcp_payload[1,1]<='9'


##############################################################################
########################    NO.03 :  POP3_RULE_SET   #########################
##############################################################################

[POP3_RULE_01]
rule_shift	= yes
rule_id		= 58
protocol	= POP3
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 1
finger_minlen	= 7
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|5]=+OK%20,+ok%20,-ERR%20,-err%20
verify_shift	= yes
verify_direc	= request
verify_depth	= 3
verify_minlen	= 6
verify_match	= [0|0|4]=QUIT,quit,STAT,stat,LIST,list
verify_plugin	= tail_0x0d0x0a_check
verify_bpf_vm	=
store_shift     = yes

[POP3_RULE_02]
rule_shift	= yes
rule_id		= 59
protocol	= POP3
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 1
finger_minlen	= 7
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|5]=+OK%20,+ok%20,-ERR%20,-err%20
verify_shift	= yes
verify_direc	= request
verify_depth	= 20
verify_minlen	= 3
verify_match	= [0|0|4]=TOP,top,UIDL,uidl,USER,user,PASS,pass,APOP,apop,RETR,retr,DELE,dele,NOOP,noop,REST,rest
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

##############################################################################
########################    NO.04 :  SMTP_RULE_SET   #########################
##############################################################################

[SMTP_RULE_01]
rule_shift	= yes
rule_id		= 60
protocol	= SMTP
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 1
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=220%20,421%20,500%20,501%20
verify_shift	= yes
verify_direc	= request
verify_depth	= 20
verify_minlen	= 5
verify_match	= [0|0|4]=HELO%20,EHLO%20,DATA%20,RSET%20,VRFY%20,EXPN%20,HELP%20,NOOP%20,QUIT%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[SMTP_RULE_02]
rule_shift	= yes
rule_id		= 61
protocol	= SMTP
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 1
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=220%20,421%20,500%20,501%20
verify_shift	= yes
verify_direc	= request
verify_depth	= 20
verify_minlen	= 11
verify_match	= [0|0|11]=MAIL%20FROM:%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[SMTP_RULE_03]
rule_shift	= yes
rule_id		= 62
protocol	= SMTP
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 1
finger_minlen	= 6
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
finger_match	= [0|0|4]=220%20,421%20,500%20,501%20
verify_shift	= yes
verify_direc	= request
verify_depth	= 20
verify_minlen	= 9
verify_match	= [0|0|9]=RCPT%20TO:%20
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

##############################################################################
#######################    NO.05 :  TELNET_RULE_SET   ########################
##############################################################################

[TELNET_RULE_01]
rule_shift	= yes
rule_id		= 63
protocol	= TELNET
layer4_proto	= TCP
finger_direc	= respons
finger_depth	= 9
finger_minlen	= 5
finger_plugin	=
finger_bpf_vm	=
finger_match	= [0|0|1]=%ff&&[0|1|1]=%fb,%fc,%fd,%fe&&[0|3|1]=%ff&&[0|4|1]=%fb,%fc,%fd,%fe
verify_shift	= yes
verify_direc	= respons
verify_depth	= 9
verify_minlen	= 6
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[2:1]!=0xf0 and ether[2:1]!=0xfa and ether[2:1]!=0xfb and ether[2:1]!=0xfc and ether[2:1]!=0xfd and ether[2:1]!=0xfe and ether[2:1]!=0xff and ether[5:1]!=0xf0 and ether[5:1]!=0xfa and ether[5:1]!=0xfb and ether[5:1]!=0xfc and ether[5:1]!=0xfd and ether[5:1]!=0xfe and ether[5:1]!=0xff
store_shift     = yes
## tcp_payload[2:1]!=%f0,%fa,%fb,%fc,%fd,%fe,%ff and tcp_payload[5:1]!=%f0,%fa,%fb,%fc,%fd,%fe,%ff

[TELNET_RULE_02]
rule_shift	= yes
rule_id		= 64
protocol	= TELNET
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 9
finger_minlen	= 5
finger_plugin	=
finger_bpf_vm	=
finger_match	= [0|0|1]=%ff&&[0|1|1]=%fb,%fc,%fd,%fe&&[0|3|1]=%ff&&[0|4|1]=%fb,%fc,%fd,%fe
verify_shift	= yes
verify_direc	= request
verify_depth	= 9
verify_minlen	= 6
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[2:1]!=0xf0 and ether[2:1]!=0xfa and ether[2:1]!=0xfb and ether[2:1]!=0xfc and ether[2:1]!=0xfd and ether[2:1]!=0xfe and ether[2:1]!=0xff and ether[5:1]!=0xf0 and ether[5:1]!=0xfa and ether[5:1]!=0xfb and ether[5:1]!=0xfc and ether[5:1]!=0xfd and ether[5:1]!=0xfe and ether[5:1]!=0xff
store_shift     = yes
## tcp_payload[2:1]!=%f0,%fa,%fb,%fc,%fd,%fe,%ff and tcp_payload[5:1]=%f0,%fa,%fb,%fc,%fd,%fe,%ff

[TELNET_RULE_03]
rule_shift	= yes
rule_id		= 65
protocol	= TELNET
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 9
finger_minlen	= 2
finger_plugin	=
finger_bpf_vm	=
finger_match	= [0|0|1]=%ff&&[0|1|1]=%fa
verify_shift	= yes
verify_direc	= request
verify_depth	= 9
verify_minlen	= 3
verify_match	=
verify_plugin	=
verify_bpf_vm	= ether[2:1]!=0xf0 and ether[2:1]!=0xfa and ether[2:1]!=0xfb and ether[2:1]!=0xfc and ether[2:1]!=0xfd and ether[2:1]!=0xfe and ether[2:1]!=0xff 
store_shift     = yes
## tcp_payload[2:1]!=%f0,%fa,%fb,%fc,%fd,%fe,%ff

##############################################################################
#######################    NO.06 :  KAZAA_RULE_SET    ########################
##############################################################################

[KAZAA_UDP_RULE_01]
rule_shift	= yes
rule_id		= 66
protocol	= KAZAA
layer4_proto	= UDP
finger_direc	= request
finger_depth	=
finger_minlen	= 11
finger_match	= [0|0|11]=%27%00%00%00%a9%80KaZaA
finger_plugin	=
finger_bpf_vm	=
verify_shift	=
verify_direc	=
verify_depth	=
verify_minlen	=
verify_match	=
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[KAZAA_UDP_RULE_02]
rule_shift	= yes
rule_id		= 67
protocol	= KAZAA
layer4_proto	= UDP
finger_direc	= request
finger_depth	=
finger_minlen	= 16
finger_match	= [0|0|6]=%28%00%00%00%a9%00&&[0|12|5]=KaZaA
finger_plugin	=
finger_bpf_vm	=
verify_shift	=
verify_direc	=
verify_depth	=
verify_minlen	=
verify_match	=
verify_plugin	=
verify_bpf_vm	=
store_shift     = no

[KAZAA_TCP_RULE_01]
rule_shift	= yes
rule_id		= 68
protocol	= KAZAA
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 30
finger_minlen	= 58
finger_match	= [0|0|10]=GET%20%2f.hash
finger_plugin	= kazaa_tcp_finger_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 30
verify_minlen	= 68
verify_match	= [0|0|15]=HTTP/1.1%20200%20OK
verify_plugin	= kazaa_tcp_verify_plugin
verify_bpf_vm	=
store_shift     = yes

##############################################################################
#######################     NO.07 :  ED2K_RULE_SET    ########################
##############################################################################

[ED2K_TCP_RULE_01]
rule_shift	= yes
rule_id		= 71
protocol	= ED2K
layer4_proto	= TCP
finger_direc	= both
finger_depth	= 3
finger_minlen	= 6
finger_match	= [0|0|1]=%e3&&[0|5|1]=%01,%38,%40,%4c,%15,%14,%34,%32,%16,%19,%41,%42,%86,%87,%54,%55,%46,%47,%92,%93,%50,%4e,%48,%56,%57,%58,%59,%51,%52,%4d,%49
finger_plugin	= ed2k_tcp_plugin
finger_bpf_vm	=
verify_shift	= no
verify_direc	= both
verify_depth	= 80
verify_minlen	= 6
verify_match	=  [0|0|1]=%e3&&[0|5|1]=%01,%38,%40,%4c,%15,%14,%34,%32,%16,%19,%41,%42,%86,%87,%54,%55,%46,%47,%92,%93,%50,%4e,%48,%56,%57,%58,%59,%51,%52,%4d,%49
verify_plugin	= ed2k_tcp_plugin
verify_bpf_vm	=
store_shift     = no

[ED2K_TCP_RULE_02]
rule_shift      = yes
rule_id         = 72
protocol        = ED2K
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 6
finger_minlen   = 6
finger_match    = [0|0|1]=%c5&&[0|5|1]=%61,%40,%02,%01,%60,%87,%a4,%85,%86,%93
finger_plugin   = ed2k_tcp_plugin
finger_bpf_vm   =
verify_shift    = no
verify_direc    = respons
verify_depth    = 10
verify_minlen   = 6
verify_match    = [0|0|1]=%c5&&[0|5|1]=%61,%40,%02,%01,%60,%87,%a4,%85,%86,%93
verify_plugin   = ed2k_tcp_plugin
verify_bpf_vm   =
store_shift     = no

[ED2K_UDP_RULE_01]
rule_shift      = yes
rule_id         = 73
protocol        = ED2K
layer4_proto    = UDP
finger_direc    = request
finger_depth    = 
finger_minlen   = 6
finger_match    = [0|0|1]=%e3&&[0|1|1]=%96,%97,%a2,%9a,%9b,%92
finger_plugin   = 
finger_bpf_vm   =
verify_shift    = 
verify_direc    = 
verify_depth    = 
verify_minlen   = 
verify_match    = 
verify_plugin   =
verify_bpf_vm   =
store_shift     = no

[ED2K_UDP_RULE_02]
rule_shift      = yes
rule_id         = 74
protocol        = ED2K
layer4_proto    = UDP
finger_direc    = request
finger_depth    = 
finger_minlen   = 6
finger_match    = [0|0|1]=%e4&&[0|1|1]=%00,%10,%20,%18,%52,%58,%59,%28,%50,%40,%11
finger_plugin   = 
finger_bpf_vm   =
verify_shift    = 
verify_direc    = 
verify_depth    = 
verify_minlen   = 
verify_match    = 
verify_plugin   =
verify_bpf_vm   =
store_shift     = no

##############################################################################
#######################      NO.08 :  BT_RULE_SET     ########################
##############################################################################

[BT_TCP_RULE_01]
rule_shift	= yes
rule_id		= 81 
protocol	= BT
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 3
finger_minlen	= 68
finger_match	= [0|0|20]=%13BitTorrent%20protocol
finger_plugin	= bittorrent_plugin
finger_bpf_vm	=
verify_shift	= no
verify_direc	= respons
verify_depth	= 5
verify_minlen	= 68
verify_match	= [0|0|20]=%13BitTorrent%20protocol
verify_plugin	= bittorrent_plugin
verify_bpf_vm	=
store_shift     = no

[BT_TCP_RULE_01]
rule_shift	= yes
rule_id		= 82
protocol	= BT
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 1
finger_minlen	= 68
finger_match	= [0|0|24]=GET%20/announce?info_hash%3d&&[1|3|4]=%0d%0a%0d%0a
finger_plugin	= 
finger_bpf_vm	=
verify_shift	= no
verify_direc	= 
verify_depth	= 
verify_minlen	= 
verify_match	= 
verify_plugin	= 
verify_bpf_vm	=
store_shift     = no

[BT_UDP_RULE_01]
rule_shift	= yes
rule_id		= 83
protocol	= BT
layer4_proto	= UDP
finger_direc	= request
finger_depth	=
finger_minlen	= 68
finger_match	= [0|0|20]=%13BitTorrent%20protocol
finger_plugin	= bittorrent_plugin
finger_bpf_vm	=
verify_shift	= no
verify_direc	=
verify_depth	=
verify_minlen	=
verify_match	=
verify_plugin	=
verify_bpf_vm	=
store_shift     = no

##############################################################################
#######################   NO.09 :  GNUTELLA_RULE_SE
##############################################################################

[GNUTELLA_TCP_CONNECTION_BETWEEN_PEER]
rule_shift	= yes
rule_id		= 91
protocol	= GNUTELLA
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 1
finger_minlen	= 60
finger_match	= [0|0|17]=GNUTELLA%20CONNECT%2f&&[1|3|4]=%0d%0a%0d%0a
finger_plugin	= gnutella_tcp_peer_conn_finger_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 2
verify_minlen	= 60
verify_match	= [0|0|9]=GNUTELLA%2f&&[1|3|4]=%0d%0a%0d%0a
verify_plugin	= gnutella_tcp_peer_conn_verify_plugin
verify_bpf_vm	=
store_shift     = yes

[GNUTELLA_TCP_FILE_TRANSFER_BETWEEN_PEER]
rule_shift	= yes
rule_id		= 92
protocol	= GNUTELLA
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 100
finger_minlen	= 60
finger_match	= [0|0|13]=GET%20%2fget%2f,GET%20%2furi-res%2f,GIV%20
finger_plugin	= gnutella_tcp_file_trans_finger_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 100
verify_minlen	= 60
verify_match	= [0|0|22]=HTTP%2f1.1%20200%20OK%0d%0aServer: 
verify_plugin	=
verify_bpf_vm	=
store_shift     = yes

[GNUTELLA_TCP_AFTER_CONN_BETWEEN_PEER]
rule_shift      = yes
rule_id         = 93
protocol        = GNUTELLA
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 100
finger_minlen   = 23
finger_match    = [0|16|1]=%01,%02,%80,%81,%40
finger_plugin   = gnutella_tcp_after_conn_between_peer
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 100
verify_minlen   = 23
verify_match    = [0|16|1]=%01,%02,%80,%81,%40
verify_plugin   = gnutella_tcp_after_conn_between_peer
verify_bpf_vm   =
store_shift     = yes

[GNUTELLA_UDP_NETWORK_TOP_UPDATE]
rule_shift	= yes
rule_id		= 94
protocol	= GNUTELLA
layer4_proto	= UDP
finger_direc	= request
finger_depth	= 
finger_minlen	= 8
finger_match	= [0|0|3]=GND&&[0|3|1]=%01,%02
finger_plugin	= 
finger_bpf_vm	=
verify_shift	= 
verify_direc	= 
verify_depth	= 
verify_minlen	= 
verify_match	= 
verify_plugin	=
verify_bpf_vm	=
store_shift     = no

##############################################################################
#######################     NO.10 :  MSN_RULE_SET     ########################
##############################################################################

[MSN_TCP_VER_CMD]
rule_shift	= yes
rule_id		= 101
protocol	= MSN
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 6
finger_minlen	= 11
finger_match	= [0|0|4]=VER%20&&[1|6|7]=%20CVR0%0d%0a
finger_plugin	= msn_tcp_ver_cmd_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 6
verify_minlen	= 11
verify_match	= [0|0|4]=VER%20&&[1|6|7]=%20CVR0%0d%0a
verify_plugin	= msn_tcp_ver_cmd_plugin
verify_bpf_vm	=
store_shift     = yes

[MSN_TCP_USR_CMD]
rule_shift	= yes
rule_id		= 102
protocol	= MSN
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 20
finger_minlen	= 11
finger_match	= [0|0|4]=USR%20
finger_plugin	= tail_0x0d0x0a_check
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 20
verify_minlen	= 11
verify_match	= [0|0|4]=USR%20&&[1|1|2]=%0d%0a
verify_plugin	= msn_tcp_usr_cmd_plugin
verify_bpf_vm	=
store_shift     = yes

[MSN_TCP_MSG_CMD]
rule_shift      = yes
rule_id         = 103
protocol        = MSN
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 200
finger_minlen   = 60
finger_match    = [0|0|4]=MSG%20
finger_plugin   = msn_tcp_msg_cmd_finger_plugin
finger_bpf_vm   =
verify_shift    = no
verify_direc    = respons
verify_depth    = 200
verify_minlen   = 60
verify_match    = [0|0|4]=MSG%20&&[1|3|4]=%0d%0a%0d%0a
verify_plugin   = msn_tcp_msg_cmd_verify_plugin
verify_bpf_vm   =
store_shift     = no

[MSN_TCP_CAL_CMD]
rule_shift      = yes
rule_id         = 104
protocol        = MSN
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 10
finger_minlen   = 13
finger_match    = [0|0|4]=CAL%20
finger_plugin   = msn_tcp_cal_cmd_finger_plugin
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 20
verify_minlen   = 13
verify_match    = [0|0|4]=MSG%20&&[1|3|4]=%0d%0a%0d%0a
verify_plugin   = msn_tcp_cal_cmd_verify_plugin
verify_bpf_vm   =
store_shift     = no

[MSN_TCP_CAL_CMD]
rule_shift      = yes
rule_id         = 105
protocol        = MSN
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 10
finger_minlen   = 13
finger_match    = [0|0|4]=CVR%20&&[0|5|1]=%20
finger_plugin   = msn_tcp_cvr_cmd_plugin
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 20
verify_minlen   = 13
verify_match    = [0|0|4]=CVR%20&&[0|5|1]=%20
verify_plugin   = msn_tcp_cvr_cmd_plugin
verify_bpf_vm   =
store_shift     = no


##############################################################################
#######################     NO.11 :  QQ_RULE_SET     #########################
##############################################################################

[QQ_TCP_LOGIN_REQUEST]
rule_shift	= yes
rule_id		= 111
protocol	= QQ
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 20
finger_minlen	= 10
finger_match	= [0|2|1]=%02&&[0|5|2]=%00%22&&[1|0|1]=%03
finger_plugin	= qq_tcp_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 20
verify_minlen	= 10
verify_match	= [0|2|1]=%02&&[0|5|2]=%00%22&&[1|0|1]=%03
verify_plugin	= qq_tcp_plugin
verify_bpf_vm	=
store_shift     = yes

[QQ_TCP_LOGIN_TOKEN_REQUEST]
rule_shift	= yes
rule_id		= 112
protocol	= QQ
layer4_proto	= TCP
finger_direc	= request
finger_depth	= 20
finger_minlen	= 10
finger_match	= [0|2|1]=%02&&[0|5|2]=%00%ba&&[1|0|1]=%03
finger_plugin	= qq_tcp_plugin
finger_bpf_vm	=
verify_shift	= yes
verify_direc	= respons
verify_depth	= 20
verify_minlen	= 10
verify_match	= [0|2|1]=%02&&[0|5|2]=%00%ba&&[1|0|1]=%03
verify_plugin	= qq_tcp_plugin
verify_bpf_vm	=
store_shift     = yes

[QQ_UDP_(LOGIN\LOGIN_TOKEN)_REQUEST]
rule_shift	= yes
rule_id		= 113
protocol	= QQ
layer4_proto	= UDP
finger_direc	= request
finger_depth	= 
finger_minlen	= 10
finger_match	= [0|0|1]=%02&&[0|3|2]=%00%22,%00%ba,%00%31&&[1|0|1]=%03
finger_plugin	=
finger_bpf_vm	=
verify_shift	=
verify_direc	=
verify_depth	=
verify_minlen	=
verify_match	=
verify_plugin	=
verify_bpf_vm	=
store_shift     = no

[QQ_UDP_FILE_TRANS]
rule_shift      = yes
rule_id         = 114
protocol        = QQ
layer4_proto    = UDP
finger_direc    = request
finger_depth    =
finger_minlen   = 10
finger_match    = [0|0|1]=%02
finger_plugin   = qq_udp_file_trans_plugin
finger_bpf_vm   =
verify_shift    =
verify_direc    =
verify_depth    =
verify_minlen   =
verify_match    =
verify_plugin   =
verify_bpf_vm   =
store_shift     = no


##############################################################################
#######################    NO.12 :  YMSG_RULE_SET    #########################
##############################################################################

[YMSG_TCP_CONNECT]
rule_shift      = yes
rule_id         = 121
protocol        = YMSG
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 1
finger_minlen   = 20
finger_match    = [0|0|4]=YMSG&&[0|6|4]=%00%00%00%00&&[0|10|6]=%00%4c%00%00%00%00
finger_plugin   = yahoo_im_plugin
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 2
verify_minlen   = 20
verify_match    = [0|0|4]=YMSG&&[0|6|4]=%00%00%00%00&&[0|10|2]=%00%4c
verify_plugin   = yahoo_im_plugin
verify_bpf_vm   =
store_shift     = yes

[YMSG_TCP_XXX]
rule_shift      = yes
rule_id         = 122
protocol        = YMSG
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 1
finger_minlen   = 20
finger_match    = [0|0|4]=YMSG&&[0|6|4]=%00%00%00%00&&[0|10|6]=%00%4d%00%00%00%00
finger_plugin   =
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 2
verify_minlen   = 20
verify_match    = [0|0|4]=YMSG&&[0|6|4]=%00%00%00%3d&&[0|10|2]=%00%4d
verify_plugin   =
verify_bpf_vm   =
store_shift     = no

##############################################################################
#######################    NO.13 :  POPO_RULE_SET    #########################
##############################################################################

[POPO_TCP_CONNECT]
rule_shift      = yes
rule_id         = 131
protocol        = POPO
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 2
finger_minlen   = 38
finger_match    = [0|0|14]=GET%20/popo2004/ 
finger_plugin   = popo2004_plugin
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 4 
verify_minlen   = 17
verify_match    = [0|0|17]=HTTP/1.1%20200%20OK%0d%0a
verify_plugin   = 
verify_bpf_vm   =
store_shift     = yes

##############################################################################
#######################    NO.14 :  GTALK_RULE_SET    ########################
##############################################################################

[GTALKCONNECT]
rule_shift      = yes
rule_id         = 141
protocol        = GTALK
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 10
finger_minlen   = 33
finger_match    = [0|0|19]=%3cstream:stream%20to%3d%22&&[1|2|3]=%3e%0d%0a&&[0|19|0]^google.com%22%20version%3d%22,gmail.com%22%20version%3d%22
finger_plugin   = 
finger_bpf_vm   =
verify_shift    = yes
verify_direc    = respons
verify_depth    = 10
verify_minlen   = 21
verify_match    = [0|0|0]^%3cmechanism%3eX-GOOGLE-TOKEN%3c%2fmechanism%3e,%3cstream:stream%20from%3d%22&&[0|22|0]^google.com%22,gmail.com%22
verify_plugin   =
verify_bpf_vm   =
store_shift     = yes

##############################################################################
############################    NO.15 :  MSRPC    ############################
##############################################################################

[MSRPC_...]
rule_shift      = yes
rule_id         = 151
protocol        = MSRPC
layer4_proto    = TCP
finger_direc    = request
finger_depth    = 15
finger_minlen   = 32
finger_match    = [0|0|2]=%05%00&&[0|2|1]=%0b,%00
finger_plugin   = msrpc_plugin
finger_bpf_vm   = 
verify_shift    = no
verify_direc    = respons
verify_depth    = 20
verify_minlen   = 32
verify_match    = [0|0|2]=%05%00
verify_plugin   = msrpc_plugin
verify_bpf_vm   =
store_shift     = yes
